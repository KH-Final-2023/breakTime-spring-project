<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="buRoom-mapper">
	<resultMap id="businessRoomResultMap" type="room">
		<id property="roomNo" column="ROOM_NO" />
		<result property="buId" column="BU_ID" />
		<result property="roomName" column="ROOM_NAME" />
		<result property="roomCount" column="ROOM_COUNT" />
		<result property="roomPrice" column="ROOM_PRICE" />
		<result property="roomInfo" column="ROOM_INFO" />
	</resultMap>

	<resultMap id="businessRoomImgResultMap" type="roomImg">
		<id property="fileNo" column="FILE_NO" />
		<result property="roomNo" column="ROOM_NO" />
		<result property="originName" column="ORIGIN_NAME" />
		<result property="saveName" column="SAVE_NAME" />
		<result property="filePath" column="FILE_PATH" />
		<result property="fileLevel" column="FILE_LEVEL" />
		<result property="status" column="STATUS" />
	</resultMap>
		<insert id="insertBuRoom" parameterType="room" >
	<selectKey keyProperty="roomNo" resultType="int" order="BEFORE">
		SELECT SEQ_BNO.NEXTVAL FROM DUAL
	</selectKey>
		INSERT INTO ROOM
			(
			ROOM_NO,
			BU_ID,
			ROOM_COUNT,
			ROOM_NAME,
			ROOM_PRICE,
			ROOM_INFO
			)
			VALUES
			(
		#{roomNo},
			#{buId},
			#{roomCount},
			#{roomName},
			#{roomPrice},
			#{roomInfo}
			)
		</insert>

	<insert id="insertRoomImgList" parameterType="roomImg">
		INSERT INTO
		ROOM_IMG
		(
		FILE_NO,
		ROOM_NO,
		ORIGIN_NAME,
		SAVE_NAME,
		FILE_PATH,
		FILE_LEVEL,
		STATUS
		)
		VALUES
		(
		SEQ_FNO.NEXTVAL,
		#{roomNo},
		#{originName},
		#{saveName},
		#{filePath},
		#{fileLevel},
		#{status}
		)
		
		
	</insert>
	<update id="updateRoom">
    UPDATE ROOM SET
    ROOM_COUNT = #{room.roomCount},
    ROOM_NAME = #{room.roomName},
    ROOM_PRICE = #{room.roomPrice},
    ROOM_INFO = #{room.roomInfo}
    WHERE ROOM_NO = #{roomNo}
</update>

<update id="updateRoomImg">
    <!-- 반복문을 통해 roomImgList의 각 요소를 처리해야 할 수 있습니다. -->
    <foreach collection="roomImgList" item="roomImg" separator=";">
        UPDATE ROOM_IMG SET
        ORIGIN_NAME = #{roomImg.originName},
        SAVE_NAME = #{roomImg.saveName},
        FILE_PATH = #{roomImg.filePath},
        FILE_LEVEL = #{roomImg.fileLevel},
        STATUS = #{roomImg.status}
        WHERE FILE_NO = #{roomImg.fileNo}
    </foreach>
</update>

</mapper>
